<!doctype html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
		integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
	<link rel="stylesheet" href="./ApplyOrganizer.css">

	<title>申請成為主辦</title>
</head>

<body>
	<main>
		<div class="container my-5 align-content-center">
			<div class="row justify-content-center">
				<div class="col-12 col-lg-6">
					<h1 class="text-center">申請成為主辦</h1>
					<form id="OrganizerData" asp-action="">
						<div class="mb-3 text-center">
							<img class="showImg">
							@if (isCreate == "true")
							{
							<input asp-for="UserId" value="@UserId" hidden />
							}else{
							<input asp-for="UserId" value="@UserId" hidden />
							}
						</div>
						<div class="mb-3 text-center">
							<input asp-for="Image" type="file" class="btn-check" id="orgImg">
							<label asp-for="Image" class="btn btn-outline-primary " for="orgImg">上傳頭像</label>
							<span asp-validation-for="Image" class="text-danger"></span>
						</div>
						<div class="mb-3">
							<label asp-for="Name" for="orgName" class="form-label star">主辦單位名稱</label>
							<input asp-for="Name" type="text" class="form-control" id="orgName" placeholder="請填寫主辦單位"
								v-model="Name" required>
							<span asp-validation-for="Name" class="text-danger">{{inputDataCheck.NameMsg}}</span>
						</div>
						<div class="mb-3">
							<label asp-for="Email" for="orgEmail" class="form-label star">主辦單位 Email</label>
							<div class="form-text"> 我們會將消費者的意見及疑問發送到此信箱 </div>
							<input asp-for="Email" type="email" class="form-control" id="orgEmail" v-model="Email"
								placeholder="請填寫 Email" required>
							<span asp-validation-for="Email" class="text-danger">{{inputDataCheck.EmailMsg}}</span>
						</div>
						<div class="mb-3">
							<label asp-for="Telphone" for="orgPhone" class="col-sm form-label star">主辦單位電話號碼</label>
							<div class=" form-text">活動參加人可於票券上查看此聯繫電話。</div>
							<input asp-for="Telphone" type="tel" class="orgphone form-control" id="orgPhone"
								v-model="Telphone" maxlength="11" placeholder="請填寫電話" required>
							<span asp-validation-for="Telphone"
								class="text-danger">{{inputDataCheck.TelphoneMsg}}</span>
						</div>
						<div class="mb-3">
							<label class="col-sm form-label star">收款帳戶資訊</label>
							<div class="row">
								<div class="col-4 col-lg-4">
									<input asp-for="BankCode" type="text" maxlength="4" class="form-control"
										v-model="BankCode" id="BankCode" placeholder="銀行代碼" required>
									<span asp-validation-for="BankCode"
										class="text-danger">{{inputDataCheck.BankCodeMsg}}</span>
								</div>
								<div class="col-8 col-lg-8">
									<input asp-for="BankAccount" type="text" maxlength="20" class="form-control"
										v-model="BankAccount" id="BankAccount" placeholder="請填寫銀行帳號" required>
									<span asp-validation-for="BankAccount"
										class="text-danger">{{inputDataCheck.BankAccountMsg}}</span>
								</div>
							</div>
						</div>
						<label asp-for="Description" class="form-label star">主辦單位簡介</label>
						<textarea asp-for="Description" id="introduction" class="form-control" v-model="Description"
							aria-label="With textarea" rows="6" placeholder="請填寫主辦單位簡介" maxlength="500"
							required></textarea>
						<span asp-validation-for="Description"
							class="text-danger">{{inputDataCheck.DescriptionMsg}}</span>
						<p class="text-end d-block">
							<span id="fontLange">{{Descriptionlength}}</span> / <span>500</span>
						</p>
						<button id="sumBtn" :disabled="!addVerify" type="submit"
							class="btn btn-primary w-100 mb-5">送出</button>
					</form>
				</div>
			</div>
		</div>
	</main>

	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
		integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
		crossorigin="anonymous"></script>
	<!-- <script src="./ApplyOrganizer.js"></script> -->
	<script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>
	<script>
		let OrganizerData = document.querySelector('#OrganizerData')
		let isCreate = 'true'

		let form = new Vue({
			el: '#OrganizerData',
			data: {
				addVerify: true,
				Name: '',
				Email: '',
				Telphone: '',
				BankCode: '',
				BankAccount: '',
				Description: '',
				Descriptionlength: 0,
				inputDataCheck: {
					NameError: false,
					NameMsg: '',
					EmailError: false,
					EmailMsg: '',
					TelphoneError: false,
					TelphoneMsg: '',
					BankCodeError: false,
					BankCodeMsg: '',
					BankAccountError: false,
					BankAccountMsg: '',
					DescriptionError: false,
					DescriptionMsg: '',
				}
			},
			watch: {
				Name: {
					immediate: true,
					handler() {
						if (this.Name == '') {
							this.inputDataCheck.NameError = true
							this.inputDataCheck.NameMsg = '名稱不可為空'
						} else if (this.Name.length > 20) {
							this.inputDataCheck.NameError = true
							this.inputDataCheck.NameMsg = '長度不可超過 20'
						} else {
							this.inputDataCheck.NameError = false
							this.inputDataCheck.NameMsg = ''
						}
						this.checkVerify()
					}
				},
				Email: {
					immediate: true,
					handler() {
						let regex = /^([\w\.\-]){1,64}\@([\w\.\-]){1,64}$/
						if (this.Email == '') {
							this.inputDataCheck.EmailError = true
							this.inputDataCheck.EmailMsg = 'Email 不可為空'
						} else if (!regex.test(this.Email)) {
							this.inputDataCheck.EmailError = true
							this.inputDataCheck.EmailMsg = 'Email 格式不正確'
						} else {
							this.inputDataCheck.EmailError = false
							this.inputDataCheck.EmailMsg = ''
						}
						this.checkVerify()
					}
				},
				Telphone: {
					immediate: true,
					handler() {
						let regex = /[0-9]([\w\.\-])[0-9]/
						if (this.Telphone == '') {
							this.inputDataCheck.TelphoneError = true
							this.inputDataCheck.TelphoneMsg = '電話不可為空'
						} else if (!regex.test(this.Telphone)) {
							this.inputDataCheck.TelphoneError = true
							this.inputDataCheck.TelphoneMsg = '電話格式不正確'
						} else {
							this.inputDataCheck.TelphoneError = false
							this.inputDataCheck.TelphoneMsg = ''
						}
						this.checkVerify()
					}
				},
				BankCode: {
					immediate: true,
					handler() {
						let regex = /[0-9]/
						if (this.BankCode == '') {
							this.inputDataCheck.BankCodeError = true
							this.inputDataCheck.BankCodeMsg = '銀行代碼不可為空'
						} else if (!regex.test(this.Telphone)) {
							this.inputDataCheck.BankCodeError = true
							this.inputDataCheck.BankCodeMsg = '代碼格式不正確'
						} else {
							this.inputDataCheck.BankCodeError = false
							this.inputDataCheck.BankCodeMsg = ''
						}
						this.checkVerify()
					}
				},
				BankAccount: {
					immediate: true,
					handler() {
						let regex = /[0-9]/
						if (this.BankAccount == '') {
							this.inputDataCheck.BankAccountError = true
							this.inputDataCheck.BankAccountMsg = '銀行帳號不可為空'
						} else if (!regex.test(this.Telphone)) {
							this.inputDataCheck.BankAccountError = true
							this.inputDataCheck.BankAccountMsg = '帳號格式不正確'
						} else {
							this.inputDataCheck.BankAccountError = false
							this.inputDataCheck.BankAccountMsg = ''
						}
						this.checkVerify()
					}
				},
				Description: {
					immediate: true,
					handler() {
						this.Descriptionlength = parseInt(this.Description.length)
						if (this.Description == '') {
							this.inputDataCheck.DescriptionError = true
							this.inputDataCheck.DescriptionMsg = '主辦簡介不可為空'
						} else if (this.Descriptionlength < 10) {
							this.inputDataCheck.DescriptionError = true
							this.inputDataCheck.DescriptionMsg = '請至少輸入十個字'
						} else {
							this.inputDataCheck.DescriptionError = false
							this.inputDataCheck.DescriptionMsg = ''
						}
						this.checkVerify()
					}
				},
			},
			methods: {
				checkVerify() {
					for (let prop in this.inputDataCheck) {
						if (this.inputDataCheck[prop] == true) {
							this.addVerify = false
							return
						}
						this.addVerify = true
					}
				}
			},

		})
	</script>

</body>

</html>